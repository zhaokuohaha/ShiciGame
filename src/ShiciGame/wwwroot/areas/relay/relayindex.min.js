var websocket;$().ready(function(){function n(n,t,i,r){var u=$('<li class="'+n+'"><\/li>'),o=$('<div class="user-info">\t\t\t\t\t\t<div class="user-image"><\/div>\t\t\t\t\t\t<div class="user-name">'+r+"<\/div>\t\t\t\t\t<\/div>"),f=$('<div class="chat-body '+t+'">'+i+"<\/div>"),e;n==="my-chat"?(u.addClass("flex-right "),f.addClass("chat-right"),u.append(f).append(o)):(u.addClass("flex-left "),f.addClass("chat-left"),u.append(o).append(f));$("#spanstatus").append(u);e=document.getElementById("spanstatus");e.scrollTop=e.scrollHeight}websocket=new WebSocket("ws://localhost:5002");websocket.onopen=function(){n("system-chat","chat-left chat-success","\u8fde\u63a5\u6210\u529f! \u5de6\u804a\u5929,\u53f3\u63a5\u9f99. \u7535\u8111\u7aef\u56de\u8f66\u952e\u63a5\u9f99, \u2191\u952e\u804a\u5929","\u7cfb\u7edf")};websocket.onmessage=function(t){var i=t.data.split("###");n(i[0],i[1],i[2],i[3])};websocket.onerror=function(t){n("system-chat","chat-left chat-error",t.data,"\u7cfb\u7edf")};websocket.onclose=function(){n("system-chat","chat-left chat-error","\u65ad\u5f00\u8fde\u63a5 !","\u7cfb\u7edf")};$(".btnSend").click(function(){var t=$(this).attr("id")==="send-varse"?"chat-primary":"chat-default",i=$(this).attr("id")==="send-varse"?"varse":"chat";websocket.readyState===websocket.OPEN?(n("my-chat","chat-right "+t,$("#textInput").val(),"\u6211"),websocket.send(i+"###"+$("#textInput").val())):n("system-chat","chat-left chat-error","\u8fde\u63a5\u5df2\u65ad\u5f00, \u8bf7\u91cd\u65b0\u8fde\u63a5!","\u7cfb\u7edf");$("#textInput").val("")});$("#textInput").on("keyup",function(t){if(t.keyCode==13||t.keyCode==38){var i,r;t.keyCode==13?(r="chat-primary",i="varse"):(r="chat-default",i="chat");websocket.readyState===websocket.OPEN?(n("my-chat","chat-right "+r,$("#textInput").val(),"\u6211"),websocket.send(i+"###"+$("#textInput").val())):n("system-chat","chat-left chat-error","\u8fde\u63a5\u5df2\u65ad\u5f00, \u8bf7\u91cd\u65b0\u8fde\u63a5!","\u7cfb\u7edf");$("#textInput").val("")}})});